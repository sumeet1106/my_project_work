-- sql command
-- DDL - DATA DEFINATION LANGUAGE
		
-- DML - DATA MANIPULATION  LANGUAge
-- DQL - DATA QEURY LANGUAGE
-- TCL - TRANSACTION CONTROL LANGUAGE
-- DCL -DATA CONTROL LANGUAGE


CREATE DATABASE DUMMY;

USE DUMMY;
DROP DATABASE DUMMY;
CREATE DATABASE DUMMY;
USE DUMMY;
CREATE TABLE STUDENTS(ID INT PRIMARY KEY, FIRST_NAME VARCHAR(40),LAST_NAME VARCHAR(40),CITY VARCHAR(30),AGE INT,SALARY INT DEFAULT 0,CHECK(AGE>18) );
INSERT INTO STUDENTS(ID,FIRST_NAME,LAST_NAME,CITY,AGE,SALARY)VALUES( 
1,"MUKUL","LAKHE","WARDHA",21,200000),
 (2,"SONAM","NANEPAG","NAGPUR",23,350000),
 (3,"HAMZA","SIDDIQUE","NAGPUR",21,21000), 
  (4,"AYUSH","CHAUDHARI","NAGPUR",21,21000),
(5,"ADWAIT","VIDHATE","NASHIK",22,450000),
 (6,"SONAM","MATHARU","NAGPUR",22,220000),
 (7,"AMIT","MOTHURE","AMRAVATI",24,350000);
 
 SELECT * FROM STUDENTS;
 
ALTER TABLE STUDENTS
RENAME COLUMN ID TO STUDENT_ID;

DESC STUDENTS;

UPDATE STUDENTS
SET SALARY = 55000
WHERE FIRST_NAME = 'ADWAIT';
UPDATE STUDENTS
 SET FIRST_NAME='SIMARAN'
 WHERE STUDENT_ID=6;
SELECT * FROM STUDENTS;
UPDATE STUDENTS
 SET CITY= 'MANAKAPUR'
 WHERE FIRST_NAME = 'AYUSH';
DELETE FROM STUDENTS
WHERE SALARY=25000;

SHOW TABLES;

SELECT * FROM 
STUDENTS;

SELECT FIRST_NAME, LAST_NAME
FROM STUDENTS;

SELECT * 
FROM STUDENTS
WHERE SALARY>=20000;

SELECT *
FROM STUDENTS
WHERE SALARY>=25000 AND SALARY<=45000;

SELECT *
FROM STUDENTS
WHERE FIRST_NAME='HAMZA';

SELECT *
FROM STUDENTS
WHERE FIRST_NAME='SONAM' OR FIRST_NAME='MUKUL' OR FIRST_NAME='ADWAIT';

SELECT *
FROM STUDENTS
WHERE FIRST_NAME IN ("SONAM","MUKUL","ADWAIT");

SELECT * 
FROM STUDENTS
WHERE FIRST_NAME NOT IN ("SONAM","MUKUL","ADWAIT");

SELECT *
FROM STUDENTS
WHERE SALARY BETWEEN 300000 AND 400000;

SELECT *
FROM STUDENTS
WHERE FIRST_NAME LIKE "%SH";

SELECT *
FROM STUDENTS
WHERE FIRST_NAME LIKE "%";

SELECT *
FROM STUDENTS
WHERE FIRST_NAME LIKE "%0%";

SELECT LENGTH(FIRST_NAME),FIRST_NAME
FROM STUDENTS
WHERE FIRST_NAME LIKE "-------";

SELECT LENGTH(FIRST_NAME),FIRST_NAME
FROM STUDENTS
WHERE FIRST_NAME LIKE "_____";

SELECT *
FROM STUDENTS
ORDER BY FIRST_NAME ;

SELECT *
FROM STUDENTS
ORDER BY FIRST_NAME DESC;

SELECT *
FROM STUDENTS
ORDER BY SALARY ;

SELECT MAX(SALARY)
FROM STUDENTS;

SELECT MIN(SALARY),COUNT(FIRST_NAME),AVG(SALARY)
FROM STUDENTS;

SELECT (SALARY*0.1) AS PF, FIRST_NAME
FROM STUDENTS;

SELECT CITY, SUM(SALARY)
FROM STUDENTS
GROUP BY CITY
ORDER BY SUM(SALARY) DESC LIMIT 1;

SELECT MAX(SALARY)
FROM STUDENTS
WHERE SALARY <(SELECT MAX(SALARY)
FROM STUDENTS)
ORDER BY SALARY DESC LIMIT 1;
 
 SELECT CITY,SUM(SALARY)
 FROM STUDENTS
 GROUP BY CITY
 ORDER BY SUM(SALARY) DESC LIMIT 1 OFFSET 1;
 
 
 USE DUMMY;
 -- 02-11-25
 -- ELIAS
 
 SELECT LOWER(FIRST_NAME) AS FIRST_NAME,UPPER(FIRST_NAME) AS LAST_NAME
 FROM STUDENTS;
 
 SELECT First_NAME, LENGTH(FIRST_NAME) AS LENGTH
 FROM STUDENTS;
 
 
SELECT CONCAT(FIRST_NAME,' ',LAST_NAME) AS FULL_NAME
FROM STUDENTS;

SELECT FIRST_NAME,LEFT(FIRST_NAME,3) AS LEFT_CHAR,RIGHT(FIRST_NAME,3),SUBSTR(FIRST_NAME,3,3)
FROM STUDENTS;

SELECT TRIM(FIRST_NAME)
FROM STUDENTS; 

SELECT CONCAT(LEFT(FIRST_NAME,1),LOWER(SUBSTRING(FIRST_NAME,2,(LENGTH(FIRST_NAME)-1)))," ",LEFT(LAST_NAME,1),LOWER(SUBSTRING(LAST_NAME,2,(LENGTH(LAST_NAME)-1))))
FROM STUDENTS;

CREATE TABLE EMPLOYEE(EMP_ID INT PRIMARY KEY AUTO_INCREMENT,NAME VARCHAR(40),AGE INT,
SALARY INT NOT NULL, CHECK (AGE>18),DEPT_ID INT);

CREATE TABLE DEPARTMENT(DEPT_ID INT PRIMARY KEY AUTO_INCREMENT,
DEPART_NAME VARCHAR(40),
LOCATION VARCHAR(40));
INSERT INTO DEPARTMENT(DEPT_ID,DEPART_NAME,LOCATION)VALUES(1,"DA","PUNE");
INSERT INTO DEPARTMENT(DEPART_NAME,LOCATION)VALUES("DS","MUMBAI"),("DA","HYDERBAD"),("DA","PUNE");

INSERT INTO EMPLOYEE (EMP_ID, NAME, AGE, SALARY, DEPT_ID)
VALUES
(1, 'SUMIT', 25, 25000, 1),
(2, 'SUMITA', 26, 300000, 2),
(3, 'SUM', 29, 36000, 4),
(4, 'MITA', 29, 35000, 5);


SELECT * FROM DEPARTMENT;

SELECT * FROM EMPLOYEE;

SELECT E.NAME,E.AGE,E.SALARY,D.LOCATION
FROM EMPLOYEE AS E
INNER JOIN DEPARTMENT AS D
ON D.DEPT_ID=DEPT_ID;

SELECT E.NAME,E.AGE,E.SALARY,D.LOCATION
FROM EMPLOYEE AS E
LEFT JOIN DEPARTMENT AS D
ON D.DEPT_ID=DEPT_ID;

SELECT E.NAME,E.AGE,E.SALARY,D.LOCATION
FROM EMPLOYEE AS E
LEFT JOIN DEPARTMENT AS D
ON D.DEPT_ID=DEPT_ID;

SELECT E.NAME,E.AGE,E.SALARY,D.LOCATION
FROM EMPLOYEE AS E
RIGHT JOIN DEPARTMENT AS D
ON D.DEPT_ID=DEPT_ID;

SELECT E.NAME,E.AGE,E.SALARY,D.LOCATION
FROM EMPLOYEE AS E
LEFT JOIN DEPARTMENT AS D
ON D.DEPT_ID=DEPT_ID
UNION
SELECT E.NAME,E.AGE,E.SALARY,D.LOCATION
FROM EMPLOYEE AS E
RIGHT JOIN DEPARTMENT AS D
ON D.DEPT_ID=DEPT_ID;

CREATE TABLE EMP_MANAGER(EMP_ID INT, NAME VARCHAR(50),MANAGER_ID INT);

INSERT INTO EMP_MANAGER()VALUES(1,"AMIT",NULL),(2,"SITA",1),(3,"RAVI",1),(4,"PRIYA",2),(5,"RAJ",2);

SELECT E.NAME AS EMPLOYEE,M.NAME AS MANAGER
FROM M.MANAGER AS M
LEFT JOIN EMP_MANAGER AS E
ON E.MANAGER_ID=EMP_ID;

CREATE TABLE employees (
  emp_id INT PRIMARY KEY AUTO_INCREMENT,
  name VARCHAR(50) NOT NULL,
  department VARCHAR(30),
  salary DECIMAL(10,2),
  hire_date DATE
);

INSERT INTO employees (name, department, salary, hire_date) VALUES
('Amit', 'IT', 60000.00, '2022-05-10'),
('Sita', 'HR', 50000.00, '2021-09-12'),
('Ravi', 'Finance', 75000.00, '2023-03-01'),
('Neha', 'IT', 65000.00, '2022-08-20'),
('Karan', 'Finance', 48000.00, '2021-12-10'),
('Pooja', 'HR', 70000.00, '2020-07-15');
 
 SELECT * 
 FROM EMPLOYEES
 WHERE YEAR(HIRE_DATE) = 2022;
select *
from employees
where salary > 20000;